
<!doctype html>
<html lang="en">
	<head>


<meta charset="utf-8">
<meta name="description" content="Use the Talend Cloud API Designer public API to automatically update your API to Azure API Management." /><meta name="viewport" content="width=device-width, initial-scale=1" />


<meta property="og:type" content="website" />
<meta property="og:url" content="/en/docs/tutorials/deploying-api-def-to-azure-api-management/">


<link rel="icon" type="image/svg+xml" href="../../../../img/brand-logo.png" sizes="196x196" />
<link rel="apple-touch-icon" href="../../../../img/brand-logo.png" sizes="196x196" />
<link rel="alternate icon" href="../../../../favicon.ico" />

<link rel="stylesheet" href="../../../../css/full.min.40a9360c1694a39611cb840439eb2478e96e8f3ae2ddfdc503283e5ec52026ea.css" media="all" />


<meta name="theme-color" content="#fafafa" />
</head>
	<body class="container">
		<header class="header">


<ul class="header__menu">
  <li class="header__item">
    <a class="header__link header__brand " href="../../../../" >
      <span class="sr-only">Home</span>
      <span>API Portal</span>
    </a>
  </li>
<li class="header__item">
    <a href="../../../../getting-started/" class="header__link"  >Getting started</a>
  </li>
<li class="header__item">
    <a href="../../../../apis/" class="header__link"  >APIs</a>
  </li>
<li class="header__item">
    <a href="../../../../en/docs/" class="header__link header__section--active"  >Documentation</a>
  </li>
</ul>
</header>
		<main id="content" class="wysiwyg">


<nav class="breadcrumb" aria-label="Breadcrumb">
	<ol class="breadcrumb__list">
		<li class="breadcrumb__item"><a href="../../../../" class="breadcrumb__element">Home</a></li>
<li class="breadcrumb__item"><span class="breadcrumb__separator" aria-hidden="true"> / </span><a href="../../../../en/" class="breadcrumb__element">Ens</a></li>
    <li class="breadcrumb__item"><span class="breadcrumb__separator" aria-hidden="true"> / </span><a href="../../../../en/docs/" class="breadcrumb__element">Documentation</a></li>
    <li class="breadcrumb__item"><span class="breadcrumb__separator" aria-hidden="true"> / </span><a href="../../../../en/docs/tutorials/" class="breadcrumb__element">Tutorials</a></li>
    <li class="breadcrumb__item"><span class="breadcrumb__separator" aria-hidden="true"> / </span><a aria-current="page" href="../../../../en/docs/tutorials/deploying-api-def-to-azure-api-management/" class="breadcrumb__element"></a></li>
    </ol>
</nav>
<h1 id="deploying-an-api-definition-to-azure-api-management">Deploying an API definition to Azure API Management</h1>
<p>This example explains how to import a new API definition or update an existing one in Azure API Management from Talend Cloud API Designer.</p>
<p><img src="../../../../img/talendcloud_to_azure_api_managment.png" alt="Talend Cloud to Aure API Management"></p>
<p>To do this, you first have to fetch your API from Talend Cloud, then you need to deploy it to Azure API Management using a command line script or a CI/CD pipeline.</p>
<p>The following procedures use Microsoft PowerShell, but you can also use the Azure API Management REST API.</p>
<p>For more information, see the following resources:</p>
<ul>
<li><a href="https://help.talend.com/access/sources/content/map?pageid=tapid_ug&amp;EnrichVersion=Cloud&amp;afs:lang=en">Talend Cloud API Designer User Guide</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/api-management/">Azure API Management documentation</a></li>
<li><a href="https://docs.microsoft.com/en-us/powershell/scripting/overview?view=powershell-6">Microsoft PowerShell documentation</a></li>
<li><a href="https://docs.microsoft.com/en-us/powershell/module/az.apimanagement/?view=azps-2.4.0#api_management">Azure PowerShell API Management documentation</a></li>
<li><a href="https://docs.microsoft.com/en-us/rest/api/apimanagement/">Azure API Management REST API Reference</a></li>
</ul>
<h2 id="fetching-an-api-definition-for-azure-api-management">Fetching an API definition for Azure API Management</h2>
<p>Export an API defintion as a JSON file compatible with Azure API Management from Talend Cloud API Designer.</p>
<p>Make sure that:</p>
<ul>
<li>You have installed cURL. For more information, see the <a href="https://curl.haxx.se/docs/">cURL documentation</a>.</li>
<li>You have generated a Personal Access Token from Talend Cloud. For more information, see the <a href="https://help.talend.com/access/sources/content/map?pageid=tapid_ug&amp;EnrichVersion=Cloud&amp;afs:lang=en">Talend Cloud API Designer User Guide</a>.</li>
<li>You have created an API in Talend Cloud API Designer.</li>
</ul>
<ol>
<li>Open a command line and enter the following command to export your API definition:
<pre><code>curl --header &quot;Authorization:Bearer {userToken}&quot; -X GET -o {outFile}.json https://apid.{region}.cloud.talend.com/api/v1/api-definitions/{api-id}?format=Swagger20Azure
</code></pre></li>
<li>Add the correct parameters:
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>{userToken}</td>
<td>Token generated from Talend Cloud.</td>
</tr>
<tr>
<td>{outFile}</td>
<td>Path and filename of your API definition. For example: contactsapi.json</td>
</tr>
<tr>
<td>{region}</td>
<td>Region for your Talend Cloud account. The value can be: us, eu, ap, at. For more information, see <a href="https://help.talend.com/access/sources/content/map?pageid=talend_cloud_regions&amp;EnrichVersion=Cloud&amp;afs:lang=en">Talend Cloud regions and URLs</a>.</td>
</tr>
<tr>
<td>{api-id}</td>
<td>ID of the API to fetch. To get it, open your API in Talend Cloud API Designer and go to <strong>Settings</strong> &gt; <strong>MANAGEMENT API</strong>.</td>
</tr>
</tbody>
</table>
</li>
<li>Execute the command.</li>
</ol>
<p>Your API definition is exported as a JSON file compatible with Azure API Management and saved in the selected directory.</p>
<p>For more information about exporting an API definition with an API gateway compatibility mode, see the <a href="https://help.talend.com/access/sources/content/map?pageid=tapid_ug&amp;EnrichVersion=Cloud&amp;afs:lang=en">Talend Cloud API Designer User Guide</a>.</p>
<h2 id="importing-an-api-definition-to-azure-api-management">Importing an API definition to Azure API Management</h2>
<p>Import your API definition to Azure API Management.</p>
<p>Make sure that:</p>
<ul>
<li>You have access to Azure API Manangement.</li>
<li>You have installed Microsoft PowerShell. For more information, see the <a href="https://docs.microsoft.com/en-us/powershell/scripting/install/installing-powershell?view=powershell-6">Microsoft PowerShell documentation</a>.</li>
<li>You have installed the Azure PowerShell module. For more information, see the <a href="https://docs.microsoft.com/en-us/powershell/azure/install-az-ps?view=azps-2.4.0">Microsoft Azure documentation</a>.</li>
<li>You have exported your API definition.</li>
</ul>
<ol>
<li>Open your command line.</li>
<li>To avoid setting the context in each command, you can add it as a variable by executing the following command:
<pre><code>$ApiMgmtContext = New-AzApiManagementContext -ResourceGroupName &quot;{ResourceGroupName}&quot; -ServiceName &quot;{ServiceName}&quot;
</code></pre><table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>{ResourceGroupName}</td>
<td>Group of resources associated to the service. It can be found on the Microsoft Azure portal.</td>
</tr>
<tr>
<td>{ServiceName}</td>
<td>Name of the service. It can be found on the Microsoft Azure portal.</td>
</tr>
</tbody>
</table>
</li>
<li>Enter the following command to upload the file:
<pre><code>Import-AzApiManagementApi -Context $ApiMgmtContext -SpecificationFormat &quot;{format}&quot; -SpecificationPath &quot;{yourfile}&quot; -Path &quot;{api-url-suffix}&quot; 
</code></pre></li>
<li>Add the correct parameters:
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>{format}</td>
<td>Format of the API definition to import. The value can be: <code>Swagger</code> (recommended), <code>Wadl</code>, <code>Wsdl</code>, <code>OpenApi</code></td>
</tr>
<tr>
<td>{yourfile}</td>
<td>Path and file name of the API definition you exported.</td>
</tr>
<tr>
<td>{api-url-suffix}</td>
<td>Web API path to add at the end of your API&rsquo;s public URL.</td>
</tr>
</tbody>
</table>
</li>
</ol>
<p>Your API is imported and the command line returns information about your API, such as its ID, which can be used to update it. You can check your API definition on the Azure portal.</p>
<p><img src="../../../../img/azure_portal.png" alt="Azure Portal"></p>
<p>For more information about the <code>Import-AzApiManagementApi</code> command, see the <a href="https://docs.microsoft.com/en-us/powershell/module/az.apimanagement/Import-AzApiManagementApi?view=azps-2.4.0">Azure documentation</a>.</p>
<h2 id="updating-an-api-definition-in-azure-api-management">Updating an API definition in Azure API Management</h2>
<p>Import a file to Azure API Management to update an existing definition.</p>
<p>Make sure that:</p>
<ul>
<li>You have access to Azure API Manangement.</li>
<li>You have installed Microsoft PowerShell. For more information, see the <a href="https://docs.microsoft.com/en-us/powershell/scripting/install/installing-powershell?view=powershell-6">Microsoft PowerShell documentation</a>.</li>
<li>You have installed the Azure PowerShell module. For more information, see the <a href="https://docs.microsoft.com/en-us/powershell/azure/install-az-ps?view=azps-2.4.0">Microsoft Azure documentation</a>.</li>
<li>You have exported your API definition.</li>
<li>You have uploaded a previous version of the API definition to Azure API Management.</li>
<li>You have set your context parameters as a variable. For more information, see the procedure above.</li>
</ul>
<ol>
<li>Open a command line and enter the following command to upload the file:
<pre><code>Import-AzApiManagementApi -Context $ApiMgmtContext -SpecificationFormat &quot;{format}&quot; -SpecificationPath &quot;{yourfile}&quot; -ApiId &quot;{api-id}&quot; -Path &quot;{api-url-suffix}&quot;
</code></pre></li>
<li>Add the correct parameters:
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>{format}</td>
<td>Format of the API definition to import. The value can be: <code>Swagger</code> (recommended), <code>Wadl</code>, <code>Wsdl</code>, <code>OpenApi</code></td>
</tr>
<tr>
<td>{yourfile}</td>
<td>Path and file name of the API definition you exported.</td>
</tr>
<tr>
<td>{api-id}</td>
<td>Azure API Management ID of the API to update.</td>
</tr>
<tr>
<td>{api-url-suffix}</td>
<td>Web API path to add at the end of your API&rsquo;s public URL.</td>
</tr>
</tbody>
</table>
</li>
<li>Execute the command.</li>
</ol>
<p>Your API definition is imported and the new file replaces the previous version. You can check your update on the Azure portal.</p>
<p>In this example, a first version of the API definition named <strong>Contacts API</strong>, which contained five operations was uploaded. Then, it was replaced with a new definition named <strong>Contacts API V2</strong> containing ten operations.</p>
<p><img src="../../../../img/azure_portal_2.png" alt="Azure Portal"></p>
<p>For more information about the <code>Import-AzApiManagementApi</code> command, see the <a href="https://docs.microsoft.com/en-us/powershell/module/az.apimanagement/Import-AzApiManagementApi?view=azps-2.4.0">Azure documentation</a>.</p>
</main>
		<footer class="footer">


<span>API Portal</span>
</footer>
	</body>
</html>
